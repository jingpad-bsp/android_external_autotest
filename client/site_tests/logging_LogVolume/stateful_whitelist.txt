# This is a list of regular expressions such that every file system
# entry on the stateful partition must have a full path that exactly
# matches at least one.  That includes directories, regular files, and
# special files.

# Please make every regular expression as specific as possible
# to enable everyone to know when new file is being stored on
# the stateful partition.  Every file system entry on the stateful
# partition is a liability that can result in a Chromium-OS device
# not being able to be logged into.  Please do your part in
# keeping Chromium OS a tight ship.

# Don't forget to escape dots in filenames.

# Allow any portage .keep_sys-apps_sandbox-0 style files.
/.*/.keep_[^/]+-\d

# dev_image is only for development mode, we are only concerned with
# space used for non-dev devices.
/dev_image
/dev_image/.*

/etc
/etc/omaha_id
/etc/ssh
/etc/ssh/ssh_host_dsa_key.pub
/etc/ssh/ssh_host_dsa_key
/etc/ssh/ssh_host_rsa_key.pub
/etc/ssh/ssh_host_rsa_key
/etc/localtime

/home
/home/\.shadow
/home/\.shadow/skel
/home/\.shadow/skel/\.ssh
/home/\.shadow/skel/\.bashrc
/home/\.shadow/skel/logs
/home/\.shadow/skel/\.bash_logout
/home/\.shadow/skel/\.bash_profile
/home/\.shadow/salt
/home/\.shadow/[a-z0-9]+
/home/\.shadow/[a-z0-9]+/master\.0\.salt
/home/\.shadow/[a-z0-9]+/master\.0
/home/\.shadow/[a-z0-9]+/vault
/home/\.shadow/[a-z0-9]+/vault/.*

# Autotest is running right now, so allow anything in there.
/home/autotest
/home/autotest/.*

/home/chronos
/home/chronos/\.Google
/home/chronos/\.Google/Google Talk Plugin
/home/chronos/\.Google/Google Talk Plugin/options
/home/chronos/\.Xauthority
/home/chronos/\.adobe
/home/chronos/\.adobe/Flash_Player
/home/chronos/\.adobe/Flash_Player/AssetCache
/home/chronos/\.adobe/Flash_Player/AssetCache/.*

# bash history should only exist for development users
/home/chronos/\.bash_history
/home/chronos/\.bluetooth
/home/chronos/\.bluetooth/lib
/home/chronos/\.bluetooth/lib/bluetooth
/home/chronos/\.bluetooth/lib/bluetooth/.*
/home/chronos/\.cache
/home/chronos/\.cache/chromium
/home/chronos/\.cache/chromium/Cache
/home/chronos/\.cache/chromium/Cache/.*
/home/chronos/\.cache/ibus
/home/chronos/\.cache/ibus/.*
/home/chronos/\.config
/home/chronos/\.config/chromium
/home/chronos/\.config/chromium/Default
/home/chronos/\.config/chromium/Default/Thumbnails
/home/chronos/\.config/chromium/Default/Web Data
/home/chronos/\.config/chromium/Default/Archived History
/home/chronos/\.config/chromium/Default/Archived History-journal
/home/chronos/\.config/chromium/Default/Bookmarks
/home/chronos/\.config/chromium/Default/Cookies
/home/chronos/\.config/chromium/Default/Current Tabs
/home/chronos/\.config/chromium/Default/Current Session
/home/chronos/\.config/chromium/Default/History
/home/chronos/\.config/chromium/Default/History-journal
/home/chronos/\.config/chromium/Default/History Index \d+\-\d+
/home/chronos/\.config/chromium/Default/History Index \d+\-\d+-journal
/home/chronos/\.config/chromium/Default/Local Storage
/home/chronos/\.config/chromium/Default/Local Storage/.*
/home/chronos/\.config/chromium/Default/Preferences
/home/chronos/\.config/chromium/Default/Thumbnails-journal
/home/chronos/\.config/chromium/Default/Visited Links
/home/chronos/\.config/chromium/Default/Web Data-journal
/home/chronos/\.config/chromium/SingletonLock
/home/chronos/\.config/chromium/SingletonSocket
/home/chronos/\.config/chromium/Local State
/home/chronos/\.config/chromium/Safe Browsing Bloom
/home/chronos/\.config/chromium/Safe Browsing Bloom Filter 2
/home/chronos/\.config/ibus
/home/chronos/\.config/ibus/bus
/home/chronos/\.config/ibus/bus/[0-9a-f]+-unix-\d+
/home/chronos/\.esd_auth
/home/chronos/\.fontconfig
/home/chronos/\.fontconfig/.*
/home/chronos/\.gconf
/home/chronos/\.gconf/desktop
/home/chronos/\.gconf/desktop/%gconf.xml
/home/chronos/\.gconf/desktop/ibus
/home/chronos/\.gconf/desktop/ibus/%gconf.xml
/home/chronos/\.gconf/desktop/ibus/general
/home/chronos/\.gconf/desktop/ibus/general/%gconf.xml
/home/chronos/\.gconfd
/home/chronos/\.gconfd/saved_state

# These scare me a little:
/home/chronos/\.macromedia
/home/chronos/\.macromedia/Flash_Player
/home/chronos/\.macromedia/Flash_Player/macromedia.com
/home/chronos/\.macromedia/Flash_Player/macromedia.com/support
/home/chronos/\.macromedia/Flash_Player/macromedia.com/support/flashplayer
/home/chronos/\.macromedia/Flash_Player/macromedia.com/support/flashplayer/sys
/home/chronos/\.macromedia/Flash_Player/macromedia.com/support/flashplayer/sys/.*
/home/chronos/\.macromedia/Flash_Player/#SharedObjects
/home/chronos/\.macromedia/Flash_Player/#SharedObjects/.*

/home/chronos/\.pki
/home/chronos/\.pki/nssdb
/home/chronos/\.pki/nssdb/cert9.db
/home/chronos/\.pki/nssdb/key4.db
/home/chronos/\.pki/nssdb/pkcs11.txt
/home/chronos/\.pulse-cookie
/home/chronos/\.pulse
/home/chronos/\.pulse/.*
/home/chronos/Default
/home/chronos/Downloads
/home/chronos/Downloads/.*
/home/chronos/Local State

# All user images are stored pngs with the user email address in
# the name.
/home/chronos/.*@.*\.\*_image

/home/chronos/user
/home/chronos/user/\.config
/home/chronos/user/\.config/chromium
/home/chronos/user/\.config/google-chrome
/home/chronos/user/\.fontconfig
/home/chronos/user/\.fontconfig/.*
/home/chronos/user/\.pki
/home/chronos/user/\.pki/nssdb
/home/chronos/user/\.pki/nssdb/.+.db
/home/chronos/user/\.pki/nssdb/pkcs11.txt
# Crash dumps involving processes run as "chronos" user
/home/chronos/user/crash
/home/chronos/user/crash/.*\.dmp
/home/chronos/user/log
# These are dated files which need to be cleaned up
/home/chronos/user/log/chromeos-wm\.\d{8}-\d{6}
/home/chronos/user/log/chromeos-wm\.LATEST
/home/chronos/Safe Browsing Bloom
/home/chronos/Safe Browsing Bloom-journal
/home/chronos/Safe Browsing Bloom Filter 2
/home/chronos/SingletonLock
/home/chronos/SingletonSocket

/lost\+found

# Everything under /usr/local is expected to be part of developer tools.
/usr/local/.*

/var
/var/cache
/var/cache/connman
/var/cache/connman/default.profile
/var/cache/revdep-rebuild
/var/cache/ldconfig
/var/cache/ldconfig/.*

# /var/cache/edb is metadata created on the device when emerging and
# is only populated on developer machines.
/var/cache/edb
/var/cache/edb/.*

# TODO(kmixter): Track down if these are cleaned up.
/var/cache/server-[0-9A-Z]+.xkm

/var/cache/google_offline_login_cache.txt
/var/cache/machine-id

# /var/db/pkg is used for emerging on the device and is only populated
# on developer machines.
/var/db
/var/db/pkg
/var/db/pkg/.*

/var/empty
# Be completely lenient on application state in /var/lib as it will
# grow as rootfs base packages are added and expected to be small.
/var/lib
/var/lib/.*
/var/lock
/var/log
/var/log/ConsoleKit
/var/log/ConsoleKit/history
/var/log/Xorg.0.log
/var/log/Xorg.0.log.old
/var/log/Xorg.1.log
/var/log/Xorg.1.log.old
/var/log/boot.log
/var/log/build
/var/log/cron
/var/log/cryptohome.log
/var/log/cryptohome.stderr.log
/var/log/cryptohome.stdout.log
/var/log/cryptohomed.log
# Created by emerge
/var/log/emerge.log
/var/log/faillog
/var/log/hostap.log
# This is created by laptop-mode/power syslogging
/var/log/laptopmode.log
/var/log/lastlog
/var/log/messages
# This is an autotest artifact
/var/log/messages.autotest_start
# The whole metrics tree probably should be removed
/var/log/metrics
/var/log/metrics/autotest-events
/var/log/metrics/disk_shutdown_start
/var/log/metrics/disk_shutdown_stop
/var/log/metrics/uma-events
/var/log/metrics/uptime_shutdown_stop
/var/log/metrics/uptime_shutdown_start
/var/log/portage
/var/log/portage/.*
/var/log/sandbox
/var/log/secure
/var/log/session_manager
# Existence of this indicates a graceful shutdown failure
/var/log/shutdown_force_kill_processes
# Existence of this indicates cryptohome umount failure
/var/log/shutdown_cryptohome_umount_failure
# Existence of this indicates /mnt/stateful umount failure
/var/log/shutdown_stateful_umount_failure
/var/log/softwareupdate.log
/var/log/update_engine.log
# These log files are generated by window manager during login process as
# opposed to those in cryptohome while logged in.
/var/log/window_manager
/var/log/window_manager/chromeos-wm\.\d{8}-\d{6}
/var/log/window_manager/chromeos-wm\.LATEST
/var/mail
# /var/run is entirely on tmpfs, so ignore it.
/var/run
/var/run/.*
/var/spool
/var/spool/mail
# Crash dumps involving processes run as other than "chronos" user
/var/spool/crash
/var/spool/crash/.*\.dmp
/var/spool/cron
/var/spool/cron/crontabs
/var/spool/cron/lastrun
/var/spool/cron/lastrun/cron.(daily|hourly|monthly|weekly)
/var/tmp
